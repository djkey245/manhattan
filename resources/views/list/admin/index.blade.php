@extends('layouts.app')@section('content')    <script type="text/css">        input{            color: black !important;        }    </script>    <div class="container-fluid" >        <div id="popup"></div>        <div class="row-fluid">            <div class="col-xs-1">Час</div>            <div class="col-xs-2">Дата</div>            <div class="col-xs-2">Суть роботи</div>            <div class="col-xs-1">Тип роботи</div>            <div class="col-xs-1">OTRS-ID</div>            <div class="col-xs-3">Кроки виконання</div>            <div class="col-xs-2" align="center"> Відправити </div>        </div>            <div class="row-fluid">                <div class="col-xs-1"><input type="text" id="time" class="form-control "></div>                <div class="col-xs-2"><input type="date" id="date" class="form-control "></div>                <div class="col-xs-2"><input type="text" id="title"  class="form-control "></div>                <div class="col-xs-1"><select id="type"  class="form-control ">                        <option value="---">---</option>                        <option value="OTRS">OTRS</option>                        <option value="Zabbix">Zabbix</option>                        <option value="GLPI">GLPI</option>                        <option value="MAN">MAN</option>                        <option value="FreeRadius">FreeRadius</option>                    </select></div>                <div class="col-xs-1"><input type="text" id="otrs_id"  class="form-control "></div>                <div class="col-xs-3" id="points">                    <div class="row" id="point">                        <div class="col-xs-6">                            <input type="text" class="form-control" name="points[]">                        </div>                        <div class="col-xs-1">                            <button onclick="add_point()" class="btn btn-success">+</button><br>                        </div>                        <div class="col-xs-3">                            <input type="hidden" name="docs[]" id="doc1" value="0">                            <button  class="btn btn-primary" onclick="addDoc(1); openDoc = 1;">Документація</button>                        </div>                        <div class="col-xs-2">                            <input type="hidden" name="virtuals[]" id="vrt1" value="0">                            <button  class="btn btn-default" onclick="addVRT(1); openVRT = 1;">Віртуалка</button>                        </div>                    </div>                </div>                <div class="col-xs-2" align="center"><button class="btn btn-success" onclick="save()">ОК</button></div>            </div>    </div>{{--{{dd($tests['0']->points)}}--}}    <br>    <div class="container-fluid">        {{--{{dd($tests)}}--}}        <?php $date = 0;?>        @foreach($tests as $test)            @if($date !== $test->date)                <br>                <br>                <hr>                <div class="row">                    <div class="col-xs-1">Час</div>                    <div class="col-xs-2">Суть роботи</div>                    <div class="col-xs-1">Тип роботи</div>                    <div class="col-xs-1">OTRS</div>                    <div class="col-xs-2">Кроки виконання</div>                    <div class="col-xs-3">Документація</div>                    <div class="col-xs-2">Віртуалка</div>                </div>                <b>{{$test->date}}</b>                    @else            @endif        <?php $date = $test->date;?>                <div class="row">                    <div class="col-xs-1">{{$test->time}}</div>                    <div class="col-xs-2">{{$test->title}}</div>                    <div class="col-xs-1">{{$test->type}}</div>                    @if($test->otrs_id != 0)                        <div class="col-xs-1"><a href="https://otrs.softgroup.ua/otrs/index.pl?Action=AgentTicketZoom;TicketID={{$test->otrs_id}}" target="_blank">{{$test->otrs_id}}</a></div>                    @else                        <div class="col-xs-1"></div>                    @endif                    <div class="col-xs-2">                        @foreach($test->points as $point)                            <li>{{$point->text}}</li>                            @endforeach                    </div>                    <div class="col-xs-3">                        @foreach($test->points as $point)                            @if(!empty($point->documentation_id))                                <li>                                    <a href="/article/{{$point->documentation_id}}" target="_blank">{{\App\Documentation::find($point->documentation_id)->title}}</a>                                </li>                            @endif                        @endforeach                    </div>                    <div class="col-xs-2">                        @foreach($test->points as $point)                            @if(!empty($point->virtual_id))                                <li>                                    <a href="/server/{{$point->virtuals[0]->id_server}}" target="_blank">{{$point->virtuals[0]->name}}</a>                                </li>                            @endif                        @endforeach                    </div>                </div>            <br>            @endforeach    </div>    <script>        function save() {            var type = document.getElementById('type').value;            var time = document.getElementById('time').value;            var title = document.getElementById('title').value;            var date = document.getElementById('date').value;            var otrs_id = document.getElementById('otrs_id').value;            var points_name = document.getElementsByName('points[]');            var docs_name = document.getElementsByName('docs[]');            var virtuals_name = document.getElementsByName('virtuals[]');            var points = [];            var docs = [];            var virtuals = [];            var openDoc = 0;            var openVRT = 0;            console.log(otrs_id);            for(var i = 0;i<point;i++) {                points[i] = points_name[i].value;                docs[i] = docs_name[i].value;                virtuals[i] = virtuals_name[i].value;//                alert(points_name[i].value);            }            console.log(virtuals);            console.log(docs);            console.log(points);            $.ajax({                type: 'post',                url: '/reportsAdm',                data: {                    '_token': "{{csrf_token()}}",                    'type': type,                    'time': time,                    'title': title,                    'date': date,                    'points': points,                    'docs': docs,                    'otrs_id': otrs_id,                    'virtuals': virtuals,                },                success: function (msg) {//                    $('#points').append(msg);                    location.reload();                }            });        }        function add_point() {            point++;            $('#points').append(                '<div class="row" id="point_'+point+'"><br>'+                    '<div class="col-xs-6">'+                        '<input type="text" class="form-control" name="points[]">'+                    '</div>'+                    '<div class="col-xs-1">'+                        '<button class="btn btn-danger" onclick="remove_point('+point+')">-</button>'+                    '</div>'+                    '<div class="col-xs-3">'+                        '<input type="hidden" name="docs[]" id="doc'+point+'" value="0">'+                        '<button  class="btn btn-primary" onclick="addDoc('+point+'); openDoc = '+point+';">Документація</button>'+                    '</div>'+                    '<div class="col-xs-2">'+                        '<input type="hidden" name="virtuals[]" id="vrt'+point+'" value="0">'+                        '<button  class="btn btn-default" onclick="addVRT('+point+'); openVRT = '+point+';">Віртуалка</button>'+                    '</div>'+                '</div>');        }        function remove_point(n) {            $('#point_'+n).remove();            point--;        }        function addDoc(doc){            $.ajax({                type:'post',                url: '/reports-show-doc',                data:{'_token':"{{csrf_token()}}"},                dataType: 'html',                success: function (message) {                    $('#popup').append(message);                }            });        }                function addVRT() {            $.ajax({                type:'post',                url: '/reports-show-srv',                data:{'_token':"{{csrf_token()}}"},                dataType: 'html',                success: function (message) {                    $('#popup').append(message);                }            });        }        var point = 1;        var now = new Date();        var year = now.getFullYear();        var month = (now.getMonth()+1);        var day = now.getDate();        var date = ""+year+"-0"+month+"-"+day+"";        date = date.toString();        document.getElementById('date').value = date;    </script>    @stop